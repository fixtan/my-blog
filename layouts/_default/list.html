{{ define "main" }}
  <section class="hero">
    <div class="hero-inner">
      <h1 class="no-border">AIと創作の記録をここに。</h1>
      <p class="blog-subtitle">「AIと人が、共に学び、創る場所」</p>
      <p>学びと再出発の旅路へ。</p>
    </div>
  </section>

  <div id="searchForm" role="search" class="search-bar-wrapper search-bar-form">
    <input id="searchInput" type="text" placeholder="検索…" />
    <select id="engineSwitch">
      <option value="lunr">Lunr.js</option>
      <option value="fuse">Fuse.js</option>
    </select>
  </div>
  <ul id="searchResults" class="search-results"></ul>

  {{ partial "home-info.html" . }}

  {{/* すべての注目記事のBaseFileNameを取得 */}}
  {{ $highlighted := $.Site.Params.homeInfoParams.featured.items }}

  {{/* ✅ featured記事の抽出とリンク記録 */}}
  {{/* 注目記事以外かつ Weight < 10 のものだけを featured に */}}
  {{ $featured := first 3 (where (where .Site.RegularPages "Weight" "lt" 10) "File.BaseFileName" "not in" $highlighted) }}
  {{ $featuredLinks := slice }}
  {{ range $featured }}
    {{ $featuredLinks = $featuredLinks | append .RelPermalink }}
  {{ end }}

  <!-- ✅ おすすめ記事 -->
  <h2 class="section-heading">おすすめ記事</h2>
  <section class="post-grid">
    {{ range $featured }}
      {{ partial "post-card.html" . }}
    {{ end }}
  </section>

  <!-- ✅ 最新記事（Type無視、すべて対象） -->
  <h2 class="section-heading">最新記事</h2>
  <section class="post-grid">
    {{ range first 6 (sort .Site.RegularPages "Date" "desc") }}
      {{ partial "post-card.html" . }}
    {{ end }}
  </section>

  <!-- ✅ カテゴリ別 -->
  <h2 class="section-heading">カテゴリ別の記事</h2>
  {{ range $name, $pages := .Site.Taxonomies.categories }}
    <h3 class="category-heading">{{ $name }}</h3>
    <section class="post-grid">
      {{ range $pages }}
        {{ if not (in $featuredLinks .RelPermalink) }}
          {{ partial "post-card.html" . }}
        {{ end }}
      {{ end }}
    </section>
  {{ end }}

{{ end }}